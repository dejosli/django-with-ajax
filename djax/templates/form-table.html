{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block form %}
<form method="POST" id="address-form">
    {% csrf_token %}
    <div class="form-row">
        <div class="form-group col-md-6 mb-0">
            {{ form.email|as_crispy_field }}
        </div>
        <div class="form-group col-md-6 mb-0">
            {{ form.password|as_crispy_field }}
        </div>
    </div>
    {{ form.address_1|as_crispy_field }}
    {{ form.address_2|as_crispy_field }}
    <div class="form-row">
        <div class="form-group col-md-6 mb-0">
            {{ form.city|as_crispy_field }}
        </div>
        <div class="form-group col-md-4 mb-0">
            {{ form.state|as_crispy_field }}
        </div>
        <div class="form-group col-md-2 mb-0">
            {{ form.zip_code|as_crispy_field }}
        </div>
    </div>
    {{ form.check_me_out|as_crispy_field }}
    <button type="submit" class="btn btn-primary">Sign in</button>
</form>
{% endblock form %}

{% block table %}

<table class="table">
    <caption>List of users</caption>
    <thead>
        <tr>
            <th scope="col">SL</th>
            <th scope="col">First</th>
            <th scope="col">Last</th>
            <th scope="col">Handle</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th scope="row">1</th>
            <td>Mark</td>
            <td>Otto</td>
            <td>@mdo</td>
        </tr>
        <tr>
            <th scope="row">2</th>
            <td>Jacob</td>
            <td>Thornton</td>
            <td>@fat</td>
        </tr>
        <tr>
            <th scope="row">3</th>
            <td>Larry</td>
            <td>the Bird</td>
            <td>@twitter</td>
        </tr>
    </tbody>
</table>

{% endblock table %}

{% block script %}

<script>
    // form submission with ajax using jquery
    $(document).ready(function () {
        $("#address-form").submit(function (e) {
            // prevent from normal form behaviour
            e.preventDefault();

            // serialize the form data  
            var serializedData = $(this).serialize();

            $.ajax({
                type: 'POST',
                url: "{% url 'address-create-view' %}",
                data: serializedData,
                success: function (response) {
                    //reset the form after successful submit
                    $("#address-form")[0].reset();
                    console.log(response);
                },
                error: function (response) {
                    console.log(response)
                }
            });
        });
    });

    // rendering form data into table with ajax
    
</script>

{% endblock script %}